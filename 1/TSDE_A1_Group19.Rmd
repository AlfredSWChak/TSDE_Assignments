---
title: "TSDE Group Submission Assignment 1"
subtitle: "Group 19" 
author: "Lanlan Hou (2801069) and Alfred Sou (2796840)"
output: pdf_document
---

# 1.

## a. $\phi$ = 0, 
## b. $\phi$ = 0.9, 
## c. $\phi$ = 1, 
## d. $\phi$ = 1.01
```{r <1> echo＝True, fig.dim=c(6,9),fig.align='center'}
par(mfcol = c(4, 1))
t <- 1000
phi <- 0

wn_var <- 1
wn <- rnorm(t, mean = 0, sd = wn_var)

x_t <- numeric(t)
x_0 <- 0
x_t[1] <- phi * x_0 + wn[1] 

for(i in (2:t)){
  x_t[i] <- phi * x_t[i-1] + wn[i] 
}

title_text <- bquote("Gaussian AR(1) process with " ~ phi == .(phi))

plot(x_t, type = 'l', main = title_text, 
     xlab = "time", ylab = "X_t", col = "red", lwd = 2)

phi <- 0.9

x_t[1] <- phi * x_0 + wn[1] 

for(i in (2:t)){
  x_t[i] <- phi * x_t[i-1] + wn[i] 
}

title_text <- bquote("Gaussian AR(1) process with " ~ phi == .(phi))

plot(x_t, type = 'l', main = title_text, 
     xlab = "time", ylab = "X_t", col = "red", lwd = 2)

phi <- 1

x_t[1] <- phi * x_0 + wn[1] 

for(i in (2:t)){
  x_t[i] <- phi * x_t[i-1] + wn[i] 
}

title_text <- bquote("Gaussian AR(1) process with " ~ phi == .(phi))

plot(x_t, type = 'l', main = title_text, 
     xlab = "time", ylab = "X_t", col = "red", lwd = 2)

phi <- 1.01

x_t[1] <- phi * x_0 + wn[1] 

for(i in (2:t)){
  x_t[i] <- phi * x_t[i-1] + wn[i] 
}

title_text <- bquote("Gaussian AR(1) process with " ~ phi == .(phi))

plot(x_t, type = 'l', main = title_text, 
     xlab = "time", ylab = "X_t", col = "red", lwd = 2)
```

## Comment on the diﬀerences between the plots.

# 2.
<!-- Plot the data. Plot the sample autocorrelation function (SACF) up to twenty lags. Which AR(1) process from Question 1 do you consider to be most suitable for this data set? Explain your answer. -->
```{r <2> echo＝True}
canvas_data_df <- read.csv("data_tsde_assignment_1.csv", header = FALSE)
canvas_data <- canvas_data_df$V1

title_text <- 'Data set from Canvas'

plot(canvas_data, type = 'l', main = title_text, 
     xlab = "time", ylab = "X_t", col = "red", lwd = 2)

lag <- 20
n <- length(canvas_data)
sacf_x <- numeric(lag)

for (i in (1:lag)) {
  x <- canvas_data[1:(n-i)]
  y <- canvas_data[(1+i):n]
  sacf_x[i] <- cor(x, y)
}

barplot(sacf_x,
        main = 'Sample ACF for canvas data', 
        xlab = 'lag', ylab = 'Corr', col = "red", lwd = 2)
```

## Explain your answer.

# 3.
<!-- Estimate the parameter φ using the SACF, and use the estimate to compute the corresponding model residuals. Next, use the residuals to obtain an estimate of σε and report both estimates. What does the estimate of φ tell you about the dynamic properties of the data? -->
```{r <3> echo＝True}
est_phi <- numeric(lag)

for (i in (1:lag)) {
  est_phi[i] <- sacf_x[i] ^(1/i)
}

mean_est_phi <- mean(est_phi)
print(paste('The estimated phi is', mean(est_phi)))

est_res <- numeric(n)

for (i in (2:n)) {
  est_res[i] <- canvas_data[i] - (mean_est_phi * canvas_data[i-1])
}

mean_est_res <- (1/(n-1)) * (sum(est_res[2:n]))

temp <- 0 
for (i in (2:n)) {
  temp <- temp + (est_res[i] - mean_est_res)^2
}

est_var <- (1/(n-1)) * temp

print(paste('The estimated sigma is', est_var))
```

# 4.
<!-- Do you find the AR(1) model assumptions reasonable? Explain your answer. -->
```{r <4> echo＝True, fig.dim=c(6,6), fig.align='center'}
par(mfcol = c(2, 2))
plot(est_res, type ='p',
     main = 'The residuals over time', 
     xlab = "time", ylab = "X_t", col = "red", lwd = 2
     )

hist(est_res,
     main = 'Histogram of the residuals', 
    col = "red", lwd = 2)

qqnorm(est_res, main = "QQ-plot: Normal distribution", col= "red")
qqline(est_res, col = "blue", lwd = 2)

sacf_res <- numeric(lag)

for (i in (1:lag)) {
  x <- est_res[2:(n-i)]
  y <- est_res[(2+i):n]
  sacf_res[i] <- cor(x, y)
}

barplot(sacf_res,
        main = 'Sample ACF for residuals', 
        xlab = 'lag', ylab = 'Corr', col = "red", lwd = 2)

```

# 5. 
## a. $\phi_1$ = 0.4, $\phi_2$ = 0.45
## b. $\phi_1$ = $\phi_2$ = 0.5
```{r <5> echo＝True, fig.dim=c(6,9),fig.align='center'}
par(mfcol = c(2, 1))
t <- 1000
phi_1 <- 0.4
phi_2 <- 0.45

wn_var <- 1
wn <- rnorm(t, mean = 0, sd = wn_var)

x_t <- numeric(t)
x_0 <- 0
x_t[1] <- phi_1 * x_0 + phi_2 * x_0 + wn[1] 
x_t[2] <- phi_1 * x_t[1] + phi_2 * x_0 + wn[2] 

for(i in (3:t)){
  x_t[i] <- phi_1 * x_t[i-1] + phi_2 * x_t[i-2] + wn[i] 
}

title_text <- bquote("Gaussian AR(2) process with " ~ 
                     phi[1] == .(phi_1) ~ " and " ~ 
                     phi[2] == .(phi_2))

plot(x_t, type = 'l', main = title_text, 
     xlab = "time", ylab = "X_t", col = "red", lwd = 2)

phi_1 <- 0.5
phi_2 <- 0.5

x_t <- numeric(t)
x_0 <- 0
x_t[1] <- phi_1 * x_0 + phi_2 * x_0 + wn[1] 
x_t[2] <- phi_1 * x_t[1] + phi_2 * x_0 + wn[2] 

for(i in (3:t)){
  x_t[i] <- phi_1 * x_t[i-1] + phi_2 * x_t[i-2] + wn[i] 
}

title_text <- bquote("Gaussian AR(2) process with " ~ 
                     phi[1] == .(phi_1) ~ " and " ~ 
                     phi[2] == .(phi_2))

plot(x_t, type = 'l', main = title_text, 
     xlab = "time", ylab = "X_t", col = "red", lwd = 2)

```

## Comment on the diﬀerences between the plots.

# 6.
<!-- Analytically derive the roots of the autoregressive polynomial and explain how they were obtained. Relate the results to your plots from the previous question. -->
For $\phi_1 = 0.4, \phi_2 = 0.45,$ \newline
$\phi(L) = 1 - \phi_1L - \phi_2L^2 = 1 - 0.4L - 0.45L^2 = (1-0.9L)(1+0.5L)$ \newline
Therefore, the roots are $|z_1^*|$ = 1/0.9 = 1.11 > 1 and $|z_2^*|$ = 1/0.5 = 2 > 1 

For $\phi_1 = 0.5, \phi_2 = 0.5,$ \newline
$\phi(L) = 1 - \phi_1L - \phi_2L^2 = 1 - 0.5L - 0.5L^2 = (1-L)(1+0.5L)$ \newline
Therefore, the roots are $|z_1^*|$ = 1/1 = 1 and $|z_2^*|$ = 1/0.5 = 2 > 1 

# 7.
<!-- Reconsider the Canvas data set data_tsde_assignment_1.csv. Use the given parameter values φ1 = 0.4 and φ2 = 0.45 to compute the residuals. Investigate these residuals by creating the same plots as in Question 4 of Part 1 of the assignment. Based on the given parameters, do you find the AR(2) model assumptions reasonable? If your conclusion is diﬀerent than in Question 4 of Part 1 of the assignment, then explain what might be the cause of this diﬀerence. -->
```{r <7> echo＝True, fig.dim=c(6,6), fig.align='center'}
phi_1 <- 0.4
phi_2 <- 0.45

est_res <- numeric(n)

for (i in (3:n)) {
  est_res[i] <- canvas_data[i] 
                - phi_1 * canvas_data[i-1] 
                - phi_2 * canvas_data[i-2]
}


par(mfcol = c(2, 2))
plot(est_res, type ='p',
     main = 'The residuals over time', 
     xlab = "time", ylab = "X_t", col = "red", lwd = 2
     )

hist(est_res,
     main = 'Histogram of the residuals', 
    col = "red", lwd = 2)

qqnorm(est_res, main = "QQ-plot: Normal distribution", col= "red")
qqline(est_res, col = "blue", lwd = 2)

sacf_res <- numeric(lag)

for (i in (1:lag)) {
  x <- est_res[2:(n-i)]
  y <- est_res[(2+i):n]
  sacf_res[i] <- cor(x, y)
}

barplot(sacf_res,
        main = 'Sample ACF for residuals', 
        xlab = 'lag', ylab = 'Corr', col = "red", lwd = 2)

```

# 8.

## a. $\theta_1 = 0.5$
## b. $\theta_1 = 2$
```{r <8> echo＝True, fig.dim=c(6,9),fig.align='center'}
par(mfcol = c(2, 1))
t <- 1000
theta <- 0.5

wn_var <- 1
wn <- rnorm(t, mean = 0, sd = wn_var)

x_t <- numeric(t)
wn_0 <- 0
x_t[1] <- wn[1] + theta * wn_0

for(i in (2:t)){
  x_t[i] <- wn[i] + theta * wn[i-1]
}

title_text <- bquote("MA(1) process with " ~ theta == .(theta))

plot(x_t, type = 'l', main = title_text, 
     xlab = "time", ylab = "X_t", col = "red", lwd = 2)

lag <- 20
n <- t
sacf_a <- numeric(lag)

for (i in (1:lag)) {
  x <- x_t[1:(n-i)]
  y <- x_t[(1+i):n]
  sacf_a[i] <- cor(x, y)
}

theta <- 2

x_t <- numeric(t)
wn_0 <- 0
x_t[1] <- wn[1] + theta * wn_0

for(i in (2:t)){
  x_t[i] <- wn[i] + theta * wn[i-1]
}

title_text <- bquote("MA(1) process with " ~ theta == .(theta))

plot(x_t, type = 'l', main = title_text, 
     xlab = "time", ylab = "X_t", col = "red", lwd = 2)

sacf_b <- numeric(lag)

for (i in (1:lag)) {
  x <- x_t[1:(n-i)]
  y <- x_t[(1+i):n]
  sacf_b[i] <- cor(x, y)
}

par(mfcol = c(2, 1))

theta <- 0.5

title_text <- bquote("Sample ACF for MA(1) process with " ~ theta == .(theta))

barplot(sacf_a,
        main = title_text, 
        xlab = 'lag', ylab = 'Corr', col = "red", lwd = 2)

theta <- 2

title_text <- bquote("Sample ACF for MA(1) process with " ~ theta == .(theta))

barplot(sacf_b,
        main = title_text, 
        xlab = 'lag', ylab = 'Corr', col = "red", lwd = 2)

```

## Discuss and explain the diﬀerences and similarities between your results.

# 9. 
<!-- Discuss an advantage of the ARMA(1,1) model over the MA(1) and AR(1) models. In your answer, comment specifically on the ACF of the models. -->